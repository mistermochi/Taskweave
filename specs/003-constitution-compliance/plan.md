# Implementation Plan: Constitution Compliance Roadmap

**Branch**: `003-constitution-compliance` | **Date**: 2026-02-22 | **Spec**: [spec.md](./spec.md)
**Input**: Feature specification from `/specs/003-constitution-compliance/spec.md`

**Note**: This template is filled in by the `/speckit.plan` command. See `.specify/templates/plan-template.md` for the execution workflow.

## Summary

This feature creates a compliance roadmap to bring the existing codebase in line with the newly ratified constitutional principles (VIII-XIII). Using existing anti-pattern data from the 002-anti-bloat-constitution analysis, we will implement fixes in prioritized phases.

## Technical Context

**Language/Version**: TypeScript 5.3+  
**Primary Dependencies**: ESLint, existing Jest setup  
**Storage**: N/A (codebase analysis)  
**Testing**: Jest (existing)  
**Target Platform**: Web (PWA)  
**Project Type**: Client-only web application  
**Performance Goals**: Maintain existing performance (LCP <2.5s, TTI <3.5s)  
**Constraints**: Client-side only architecture, existing codebase  
**Scale/Scope**: ~42 components, ~14 services

## Constitution Check

| Principle | Status | Notes |
|-----------|--------|-------|
| I. Exclusive Focus | ✅ Compatible | No impact on task logic |
| II. Atomic Operations | ✅ Compatible | No changes to data mutations |
| III. Real-time First | ✅ Compatible | Maintains onSnapshot patterns |
| IV. Semantic Clarity | ✅ Compatible | No terminology changes |
| V. Offline Reliability | ✅ Compatible | Maintains offline-first approach |
| VI. Test-Driven Development | ✅ Compatible | TDD principles apply to refactoring |
| VII. Client-Side Only | ✅ Compatible | All work respects client-only |
| VIII. Component Size Limits | ⚠️ VIOLATION | 4 files exceed 250 lines |
| IX. Type Safety Enforcement | ⚠️ VIOLATION | 37 'any' types exist |
| X. Code Duplication | ⚠️ VIOLATION | ContextService overuse |
| XI. Performance Budgets | ⚠️ VIOLATION | No lazy loading implemented |
| XII. Context Provider | ⚠️ VIOLATION | 6 levels deep (max 3) |
| XIII. Code Health Gates | ⚠️ VIOLATION | Not configured |

**GATE PASSED**: Violations are the reason for this roadmap - we are addressing them.

## Project Structure

### Documentation (this feature)

```
specs/003-constitution-compliance/
├── plan.md              # This file
├── research.md          # Not needed - using existing data
├── data-model.md        # Not applicable - governance doc
├── quickstart.md        # Remediation guide
└── tasks.md            # Generated by /speckit.tasks
```

### Source Code Changes

No new source code - this is a governance/planning feature that produces task lists for future implementation.

---

## Phase 0: Research

**Not needed** - Anti-pattern data already collected in 002-anti-bloat-constitution. Violations are documented in spec.md.

---

## Phase 1: Design

### Quickstart: Remediation Guide

The roadmap consists of 3 phases:

#### Phase 1: Quick Wins (1 sprint)
| Task | Violations Fixed | Exit Criteria |
|------|-----------------|---------------|
| Configure ESLint no-explicit-any | Principle IX | Rule enabled, 0 errors |
| Fix 37 'any' types | Principle IX | All types explicit |
| Remove empty controller | Principle VIII | File deleted or implemented |

#### Phase 2: Component Refactoring (2 sprints)
| Task | Violations Fixed | Exit Criteria |
|------|-----------------|---------------|
| Split TaskRow | Principle VIII | <250 lines each |
| Split RecommendationEngine | Principle VIII | <250 lines each |
| Add React.memo | Principle XI | List components memoized |

#### Phase 3: Architecture Improvements (2 sprints)
| Task | Violations Fixed | Exit Criteria |
|------|-----------------|---------------|
| Consolidate context providers | Principle XII | ≤3 levels nesting |
| Add React.lazy() | Principle XI | Route-based splitting |
| Set up CI health gates | Principle XIII | Automated checks in CI |

### Data Model

**Not applicable** - This is a governance/roadmap document, not a software feature.

### Contracts

**Not applicable** - No external interfaces.

---

## Recommended Implementation Order

1. **Phase 1**: Quick ESLint config + type fixes (low risk, high impact)
2. **Phase 2**: Component splitting (medium risk, high impact)
3. **Phase 3**: Architecture + CI (infrastructure)

---

## Notes

- This is a planning/governance feature
- The "implementation" is the roadmap document itself
- Future work will execute the remediation phases
- No tests needed for the roadmap itself
